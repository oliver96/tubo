//2013-5-22 14:19 chs
(function(e){var t=function(){function t(e){this._upcount=0,this._dncount=0,this._vid=e.vid,this._pid=e.pid||"0",this._cid=e.cid}return t.prototype={constructor:t,init:function(t){var n=this,r=this._vid,i=this._pid,s=this._cid;e.getJSON("http://score.my.tv.sohu.com/digg/get.do?vid="+r+"&type="+s+"&callback=?",function(e){try{n._upcount=e.upCount,n._dncount=e.downCount,t(n._upcount,n._dncount)}catch(r){}})},up:function(t){var n=this,r=this._vid,i=this._pid,s=this._cid;e.getJSON("http://score.my.tv.sohu.com/digg/up.do?vid="+r+"&type="+s+"&pid="+i+"&isUp=true&callback=?",function(e){n._upcount=e.upCount,t(n._upcount)})},down:function(t){var n=this,r=this._vid,i=this._pid,s=this._cid;e.getJSON("http://score.my.tv.sohu.com/digg/up.do?vid="+r+"&type="+s+"&pid="+i+"&isUp=false&callback=?",function(e){n._dncount=e.downCount,t(n._dncount)})}},t}(),n=e(".vbtn-ding"),r=e(".vbtn-cai"),i=new t({vid:window._vid=="null"?"-1":window._vid,cid:"25",pid:window._pid}),s=function(e){return e=parseInt(e,10),e};i.init(function(e,t){n.html(s(e)),r.html("<em>"+s(t)+"</em>"),n.bind("click",function(){return n.hasClass("vbtn-ding-ed")?!1:(i.up(function(e){n.html(s(e)).removeClass("vbtn-ding").addClass("vbtn-ding-ed")}),!1)}),r.bind("click",function(){return r.hasClass("vbtn-cai-ed")?!1:(i.down(function(e){r.html("<em>"+s(e)+"</em>").removeClass("vbtn-cai").addClass("vbtn-cai-ed")}),!1)})});var o=function(e,t,n,r){var i=/[^\x00-\xff]/g;n=n||!1,r=r||"...";if(t>0&&e.replace(i,"mm").length>t){var s=Math.floor(t/2);for(var o=s;o<e.length;o++)if(e.substr(0,o).replace(i,"mm").length>=t)return e.substr(0,o)+(n?r:"")}return e};window.hotTvnewsCallback=function(t){var n=["[\u70ed\u70b9]"],r,i,s,u;t&&t.data&&t.data.columnVideos[0]&&t.data.columnVideos[0].videos&&t.data.columnVideos[0].videos.length>1&&(i=t.data.columnVideos[0].videos,r=i.length,s=parseInt(Math.random()*r),u=s+1==r?0:s+1,n.push('<a href="',i[s].tv_url,'" target="_blank" title="',i[s].tv_name,'">',o(i[s].tv_name,20,!0),"</a>&nbsp;"),n.push('|&nbsp;&nbsp;<a href="',i[u].tv_url,'" target="_blank" title="',i[u].tv_name,'">',o(i[u].tv_name,22,!0),"</a>"),e(".video-mutu").html(n.join("")))},e(".video-mutu").length&&e.ajax({type:"GET",dataType:"script",url:"http://hot.vrs.sohu.com/newsbottom.json",cache:!0})})(jQuery),function(e){e.ajax({type:"GET",dataType:"script",url:"http://tv.sohu.com/upload/jq_plugin/share.js",cache:!0});var t={"s-wb-sohu":"weibosohu","s-wb-sina":"weibosina","s-kj-qq":"qq","s-rr":"renren","s-wb-qq":"tqq","s-tianyi":"tianyi","s-kx001":"kaixin001","s-py-qq":"txpengyou","s-wb-163":"163","s-msn":"msn","s-bsh":"baishehui","s-itb":"itb","s-db":"douban","s-kj-fx":"fx","s-ty":"ty","s-51":"51"};e(".video").each(function(n,r){e(r).find("div.vbtn-fa").html(["<ul>",'<li class="s-wb-sohu"><a href="#" title="\u8f6c\u53d1\u81f3\u641c\u72d0\u5fae\u535a"></a></li>','<li class="s-wb-sina"><a href="#" title="\u8f6c\u53d1\u81f3\u65b0\u6d6a\u5fae\u535a"></a></li>','<li class="s-kj-qq"><a href="#" title="\u8f6c\u53d1\u81f3QQ\u7a7a\u95f4"></a></li>','<li class="s-rr"><a href="#" title="\u8f6c\u53d1\u81f3\u4eba\u4eba\u7f51"></a></li>',"</ul>"].join("")),e(r).find("div.vbtn-fa a").click(function(){return jump(t[this.parentNode.className],null,_url,_title),!1})})}(jQuery)